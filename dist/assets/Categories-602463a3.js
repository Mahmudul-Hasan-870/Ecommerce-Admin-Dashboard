import{D as v,I as f,L as R,J as Y,c as a,k as e,p as r,E as c,G as h,M,j as V,u as m,O as j,F as S,v as U,s as P,a as J,o as n,g as K}from"./vendor-513bb039.js";import{u as Q}from"./categories-c2c1002a.js";import{u as W,_ as X}from"./PermissionDialog-ca0538f2.js";import{b as L}from"./confirm-78191804.js";import"./index-713483bf.js";import"./toast-489a8a13.js";const Z={class:"space-y-6"},ee={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},te={class:"bg-white p-4 rounded-lg shadow"},se={class:"flex items-center"},oe={class:"ml-4"},le={class:"text-2xl font-bold text-gray-900"},ie={class:"bg-white p-4 rounded-lg shadow"},ae={class:"flex items-center"},re={class:"ml-4"},ne={class:"text-2xl font-bold text-gray-900"},de={class:"bg-white p-4 rounded-lg shadow"},ue={class:"flex items-center"},ce={class:"ml-4"},pe={class:"text-2xl font-bold text-gray-900"},me={class:"bg-white p-4 rounded-lg shadow"},ve={class:"flex items-center"},ge={class:"ml-4"},xe={class:"text-2xl font-bold text-gray-900"},fe={class:"bg-white p-4 rounded-lg shadow"},ye={class:"flex items-center"},he={class:"ml-4"},be={class:"text-2xl font-bold text-gray-900"},we={class:"card"},ke={class:"flex flex-col sm:flex-row gap-4"},_e={class:"flex-1"},Ce={class:"flex gap-2"},Ae={class:"bg-white rounded-lg shadow overflow-hidden"},Me={class:"px-6 py-4 border-b border-gray-200"},Ve={class:"flex justify-between items-center"},je={class:"flex gap-2"},Be={class:"overflow-x-auto"},De={key:0,class:"flex justify-center items-center py-8"},Se={key:1,class:"flex justify-center items-center py-8"},Ue={class:"text-red-600 text-center"},Pe={class:"text-lg font-medium"},Le={key:2,class:"min-w-full divide-y divide-gray-200"},Te={class:"bg-gray-50"},$e={class:"px-6 py-3 text-left"},Ee={class:"bg-white divide-y divide-gray-200"},ze={class:"px-6 py-4 whitespace-nowrap"},Ie=["value"],Ne={class:"px-6 py-4 whitespace-nowrap"},qe={class:"flex items-center"},He={class:"flex-shrink-0 h-10 w-10"},Ge=["src","alt"],Oe={key:1,class:"h-10 w-10 rounded-lg bg-gray-200 flex items-center justify-center"},Fe={class:"ml-4"},Re={class:"text-sm font-medium text-gray-900"},Ye={class:"text-sm text-gray-500"},Je={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ke={key:0,class:"text-gray-600"},Qe={key:1,class:"text-gray-400"},We={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Xe={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Ze={class:"px-6 py-4 whitespace-nowrap"},et={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},tt={class:"flex gap-2"},st=["onClick"],ot=["onClick"],lt={class:"bg-gradient-to-r from-primary-600 to-primary-700 px-8 py-6"},it={class:"flex items-center justify-between"},at={class:"text-2xl font-bold text-white"},rt={class:"text-primary-100 mt-1"},nt={class:"p-8"},dt={class:"space-y-4"},ut=["value"],ct={class:"flex items-center"},pt={class:"flex justify-end gap-3 mt-6"},mt=["disabled"],kt={__name:"Categories",setup(vt){const i=Q(),{showPermissionDialog:T,permissionDialogData:b,checkActionPermission:w,closePermissionDialog:gt,handleGoBack:$}=W(),k=v(!1),p=v(!1),u=v([]),g=v(!1),l=v({search:"",status:"",type:""}),d=v({name:"",description:"",parent:"",image:"",isActive:!0}),x=f(()=>i.stats),_=f(()=>i.loading),E=f(()=>i.categories),z=f(()=>i.parentCategories),C=f(()=>{let o=E.value;if(l.value.search){const t=l.value.search.toLowerCase();o=o.filter(s=>s.name.toLowerCase().includes(t)||s.slug.toLowerCase().includes(t))}return l.value.status&&(o=o.filter(t=>l.value.status==="active"?t.isActive:!t.isActive)),l.value.type&&(l.value.type==="parent"?o=o.filter(t=>!t.parent):l.value.type==="sub"&&(o=o.filter(t=>t.parent))),o}),I=()=>{w("create","categories")&&(k.value=!0)},N=()=>w("edit","categories"),q=()=>w("delete","categories"),B=async()=>{try{const o={};l.value.status&&(o.status=l.value.status),l.value.type==="parent"&&(o.parent="null"),await i.fetchCategories(o),await i.fetchCategoryStats()}catch{}},H=o=>{if(!N())return;i.setSelectedCategory(o);let t="";o.parent&&(t=o.parent._id||o.parent),d.value={name:o.name,description:o.description||"",parent:t,image:o.image||"",isActive:o.isActive},p.value=!0},G=async o=>{if(!q())return;(await L({title:"Delete Category",text:"Are you sure you want to delete this category? This action cannot be undone.",icon:"warning",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed&&await i.deleteCategory(o)},D=async o=>{if(u.value.length===0)return;if((await L({title:`${o==="activate"?"Activate":"Deactivate"} Categories`,text:`Are you sure you want to ${o} ${u.value.length} categories?`,icon:"question",confirmButtonText:`Yes, ${o} them!`,cancelButtonText:"Cancel"})).isConfirmed)try{await i.bulkUpdate(u.value,o),u.value=[],g.value=!1,await new Promise(s=>setTimeout(s,100))}catch{}},O=()=>{g.value?u.value=C.value.map(o=>o._id):u.value=[]},F=async()=>{var o;try{const t={...d.value};if(t.parent===""&&(t.parent=null),p.value){const s=(o=i.selectedCategory)==null?void 0:o._id;s&&await i.updateCategory(s,t)}else await i.createCategory(t);y()}catch{}},y=()=>{k.value=!1,p.value=!1,i.clearSelectedCategory(),d.value={name:"",description:"",parent:"",image:"",isActive:!0}};return R(u,o=>{g.value=o.length===C.value.length&&o.length>0}),Y(async()=>{try{await B()}catch{}}),(o,t)=>(n(),a("div",Z,[e("div",{class:"mb-6"},[e("div",{class:"flex items-center justify-between"},[t[13]||(t[13]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Categories"),e("p",{class:"text-gray-600 dark:text-gray-400 mt-1"},"Manage your product categories")],-1)),e("div",{class:"flex items-center space-x-3"},[e("button",{onClick:I,class:"btn-primary"}," Add Category ")])])]),e("div",ee,[e("div",te,[e("div",se,[t[15]||(t[15]=e("div",{class:"p-2 bg-blue-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1)),e("div",oe,[t[14]||(t[14]=e("p",{class:"text-sm font-medium text-gray-600"},"Total",-1)),e("p",le,r(x.value.total),1)])])]),e("div",ie,[e("div",ae,[t[17]||(t[17]=e("div",{class:"p-2 bg-green-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",re,[t[16]||(t[16]=e("p",{class:"text-sm font-medium text-gray-600"},"Active",-1)),e("p",ne,r(x.value.active),1)])])]),e("div",de,[e("div",ue,[t[19]||(t[19]=e("div",{class:"p-2 bg-red-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",ce,[t[18]||(t[18]=e("p",{class:"text-sm font-medium text-gray-600"},"Inactive",-1)),e("p",pe,r(x.value.inactive),1)])])]),e("div",me,[e("div",ve,[t[21]||(t[21]=e("div",{class:"p-2 bg-purple-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"})])],-1)),e("div",ge,[t[20]||(t[20]=e("p",{class:"text-sm font-medium text-gray-600"},"Parent",-1)),e("p",xe,r(x.value.parent),1)])])]),e("div",fe,[e("div",ye,[t[23]||(t[23]=e("div",{class:"p-2 bg-orange-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1)),e("div",he,[t[22]||(t[22]=e("p",{class:"text-sm font-medium text-gray-600"},"Sub",-1)),e("p",be,r(x.value.sub),1)])])])]),e("div",we,[e("div",ke,[e("div",_e,[c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.search=s),type:"text",placeholder:"Search categories...",class:"input-field"},null,512),[[h,l.value.search]])]),e("div",Ce,[c(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.status=s),class:"input-field"},t[24]||(t[24]=[e("option",{value:""},"All Status",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)]),512),[[M,l.value.status]]),c(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.type=s),class:"input-field"},t[25]||(t[25]=[e("option",{value:""},"All Types",-1),e("option",{value:"parent"},"Parent Only",-1),e("option",{value:"sub"},"Sub Only",-1)]),512),[[M,l.value.type]])])])]),e("div",Ae,[e("div",Me,[e("div",Ve,[t[26]||(t[26]=e("h3",{class:"text-lg font-medium text-gray-900"},"Categories",-1)),e("div",je,[u.value.length>0?(n(),a("button",{key:0,onClick:t[3]||(t[3]=s=>D("activate")),class:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm"}," Activate ")):V("",!0),u.value.length>0?(n(),a("button",{key:1,onClick:t[4]||(t[4]=s=>D("deactivate")),class:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm"}," Deactivate ")):V("",!0)])])]),e("div",Be,[_.value?(n(),a("div",De,t[27]||(t[27]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1),e("span",{class:"ml-2 text-gray-600"},"Loading categories...",-1)]))):m(i).error?(n(),a("div",Se,[e("div",Ue,[t[28]||(t[28]=e("svg",{class:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),e("p",Pe,r(m(i).error),1),e("button",{onClick:B,class:"mt-4 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700"}," Try Again ")])])):(n(),a("table",Le,[e("thead",Te,[e("tr",null,[e("th",$e,[c(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>g.value=s),onChange:O,type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,544),[[j,g.value]])]),t[29]||(t[29]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Category ",-1)),t[30]||(t[30]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Parent ",-1)),t[31]||(t[31]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Level ",-1)),t[32]||(t[32]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status ",-1)),t[33]||(t[33]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ",-1))])]),e("tbody",Ee,[(n(!0),a(S,null,U(C.value,s=>(n(),a("tr",{key:s._id},[e("td",ze,[c(e("input",{"onUpdate:modelValue":t[6]||(t[6]=A=>u.value=A),value:s._id,type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,8,Ie),[[j,u.value]])]),e("td",Ne,[e("div",qe,[e("div",He,[s.image?(n(),a("img",{key:0,src:s.image,alt:s.name,class:"h-10 w-10 rounded-lg object-cover"},null,8,Ge)):(n(),a("div",Oe,t[34]||(t[34]=[e("svg",{class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1)])))]),e("div",Fe,[e("div",Re,r(s.name),1),e("div",Ye,r(s.slug),1)])])]),e("td",Je,[s.parent?(n(),a("span",Ke,r(s.parent.name),1)):(n(),a("span",Qe,"-"))]),e("td",We,[e("span",Xe," Level "+r(s.level),1)]),e("td",Ze,[e("span",{class:K(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},r(s.isActive?"Active":"Inactive"),3)]),e("td",et,[e("div",tt,[e("button",{onClick:A=>H(s),class:"text-primary-600 hover:text-primary-900"}," Edit ",8,st),e("button",{onClick:A=>G(s._id),class:"text-red-600 hover:text-red-900"}," Delete ",8,ot)])])]))),128))])]))])]),k.value||p.value?(n(),a("div",{key:0,class:"fixed inset-0 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4",onClick:y},[e("div",{class:"relative w-full max-w-2xl bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden",onClick:t[12]||(t[12]=P(()=>{},["stop"]))},[e("div",lt,[e("div",it,[e("div",null,[e("h3",at,r(p.value?"Edit Category":"Add New Category"),1),e("p",rt,r(p.value?"Update category information and settings":"Create a new category with all details"),1)]),e("button",{onClick:y,class:"text-white hover:text-primary-100 transition-colors duration-200 p-2 rounded-full hover:bg-white hover:bg-opacity-10"},t[35]||(t[35]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])]),e("div",nt,[e("form",{onSubmit:P(F,["prevent"])},[e("div",dt,[e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Name * ",-1)),c(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>d.value.name=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Category name"},null,512),[[h,d.value.name]])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Description ",-1)),c(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=s=>d.value.description=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Category description"},null,512),[[h,d.value.description]])]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Parent Category ",-1)),c(e("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>d.value.parent=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},[t[38]||(t[38]=e("option",{value:""},"No Parent (Main Category)",-1)),(n(!0),a(S,null,U(z.value,s=>(n(),a("option",{key:s._id,value:s._id},r(s.name),9,ut))),128))],512),[[M,d.value.parent]])]),e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Image URL ",-1)),c(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>d.value.image=s),type:"url",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Enter image URL"},null,512),[[h,d.value.image]])]),e("div",null,[e("label",ct,[c(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>d.value.isActive=s),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[j,d.value.isActive]]),t[41]||(t[41]=e("span",{class:"ml-2 text-sm text-gray-700"},"Active",-1))])])]),e("div",pt,[e("button",{type:"button",onClick:y,class:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300"}," Cancel "),e("button",{type:"submit",disabled:_.value,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50"},r(_.value?"Saving...":p.value?"Update":"Create"),9,mt)])],32)])])])):V("",!0),J(X,{show:m(T),title:m(b).title,message:m(b).message,"required-permissions":m(b).requiredPermissions,onGoBack:m($)},null,8,["show","title","message","required-permissions","onGoBack"])]))}};export{kt as default};
