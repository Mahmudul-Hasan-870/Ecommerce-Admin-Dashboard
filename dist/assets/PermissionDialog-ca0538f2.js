import{H as b,D as p,I as w,o as y,c as P,k as s,N as A,p as v,g as D,s as B,j as C}from"./vendor-513bb039.js";import{u as k,c as h,g as _,h as x,b as j}from"./index-713483bf.js";function E(){const u=b(),e=k(),i=p(!1),n=p({title:"",message:"",requiredPermissions:[]}),o=(t,l=null)=>{if(!e.user||!e.user.permissions)return!1;if(h(t,e.user))return!0;const f=_(t,e.user),a=j(t);return i.value=!0,n.value={title:"Access Denied",message:`You don't have permission to ${l||a}.`,requiredPermissions:f},!1},m=(t,l=null)=>!e.user||!e.user.permissions?!1:x(t,e.user)?!0:(i.value=!0,n.value={title:"Permission Required",message:`You don't have permission to ${l||"perform this action"}.`,requiredPermissions:[t]},!1),c=(t,l=null)=>{if(!e.user||!e.user.permissions)return!1;if(t.every(d=>h(d,e.user)))return!0;const a=t.filter(d=>!h(d,e.user));return i.value=!0,n.value={title:"Access Denied",message:`You don't have permission to ${l||"access this feature"}.`,requiredPermissions:a},!1},r=(t,l=null)=>{if(!e.user||!e.user.permissions)return!1;const a={create:"canCreate",edit:"canEdit",delete:"canDelete",view:"canView"}[t];if(!a||x(a,e.user))return!0;const d={create:"create new items",edit:"edit items",delete:"delete items",view:"view items"};return i.value=!0,n.value={title:"Action Denied",message:`You don't have permission to ${d[t]}.`,requiredPermissions:[a]},!1},g=()=>{i.value=!1};return{showPermissionDialog:i,permissionDialogData:n,checkPermission:o,checkSpecificPermission:m,checkPermissions:c,checkActionPermission:r,closePermissionDialog:g,handleGoBack:()=>{g(),u.go(-1)},handleContactAdmin:()=>{g()}}}const q={key:0,class:"fixed inset-0 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4"},S={class:"p-6"},M={class:"text-center"},Y={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},L={class:"text-sm text-gray-500 dark:text-gray-400 mb-4"},N={class:"bg-blue-50 dark:bg-blue-900 rounded-lg p-4 mb-6"},R={class:"flex items-center justify-center"},H={__name:"PermissionDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Access Denied"},message:{type:String,default:"You don't have the required permissions to access this feature."},requiredPermissions:{type:Array,default:()=>[]}},emits:["close","goBack"],setup(u,{emit:e}){const i=e,n=k(),o=w(()=>{var c;return((c=n.user)==null?void 0:c.role)||"unknown"}),m=()=>{i("goBack")};return(c,r)=>u.show?(y(),P("div",q,[s("div",{class:"relative w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-100 dark:border-gray-700 overflow-hidden",onClick:r[0]||(r[0]=B(()=>{},["stop"]))},[r[3]||(r[3]=A('<div class="bg-gradient-to-r from-red-600 to-red-700 px-6 py-4"><div class="flex items-center justify-between"><div class="flex items-center"><div class="flex-shrink-0"><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div><div class="ml-3"><h3 class="text-lg font-semibold text-white">Access Denied</h3><p class="text-red-100 text-sm">You don&#39;t have permission to access this feature</p></div></div></div></div>',1)),s("div",S,[s("div",M,[r[2]||(r[2]=s("div",{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900 mb-4"},[s("svg",{class:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"})])],-1)),s("h3",Y,v(u.title),1),s("p",L,v(u.message),1),s("div",N,[r[1]||(r[1]=s("h4",{class:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2"},"Your Current Role:",-1)),s("div",R,[s("span",{class:D(["inline-flex px-3 py-1 text-sm font-semibold rounded-full",{"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":o.value==="admin","bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":o.value==="manager","bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":o.value==="editor","bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":o.value==="viewer","bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200":o.value==="staff"}])},v(o.value),3)])])]),s("div",{class:"flex justify-center"},[s("button",{onClick:m,class:"btn-secondary"}," Go Back ")])])])])):C("",!0)}};export{H as _,E as u};
